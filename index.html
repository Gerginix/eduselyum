
<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <title>YKS 2025 PUAN VE SIRA SİMÜLATÖRÜ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- SEO (hafif) -->
  <meta name="description" content="2026 YKS hazırlığında deneme netlerinle 2025 YKS puan ve sıralamanı (SAY/EA/SÖZ/DİL) simüle et. OBP ile yerleştirme puanı ve sıralama hesaplama." />
  <meta property="og:title" content="YKS 2025 PUAN VE SIRA SİMÜLATÖRÜ" />
  <meta property="og:description" content="Deneme netlerin + OBP ile 2025 YKS puan ve sıralamanı simüle et (SAY/EA/SÖZ/DİL)." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="umut.jpeg" />

  <style>
    :root{
      --page-w: 380px;
      --control-w: 260px;
      --radius: 10px;
    }

    body{
      font-family: Arial, sans-serif;
      max-width: var(--page-w);
      margin: 24px auto;
      padding: 10px;
    }

    h1{
      text-align:center;
      margin: 6px 0 10px;
      font-size: 22px;
    }

    .subtitle{
      text-align:center;
      font-size: 13px;
      color:#333;
      line-height:1.45;
      margin-bottom:16px;
    }

    /* Instagram satırı (subtitle altında) */
    .igline{
      text-align:center;
      font-size: 13px;
      margin-top: 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      flex-wrap:wrap;
    }
    .igline a{
      color:#0b57d0;
      text-decoration: underline;
      word-break: break-word;
    }
    .igicon{
      width:18px;
      height:18px;
      display:inline-block;
      flex:0 0 auto;
    }

    /* Dipnot */
    .disclaimer{
      text-align:center;
      font-size:12px;
      color:#444;
      margin-top:10px;
      line-height:1.4;
    }

    label{
      font-weight:700;
      display:block;
      margin-top:10px;
      width: var(--control-w);
      margin-left:auto;
      margin-right:auto;
      font-size:14px;
    }

    input, select{
      width: var(--control-w);
      padding:8px;
      margin-top:6px;
      display:block;
      margin-left:auto;
      margin-right:auto;
      text-align:center;
    }

    button{
      width: var(--control-w);
      padding:12px;
      margin:14px auto 0;
      font-size:16px;
      font-weight:700;
      display:block;
      cursor:pointer;
    }

    /* Paylaş butonu (ikincil) */
    .btn-secondary{
      margin-top:10px;
      font-size:14px;
      font-weight:700;
      opacity:0.92;
    }

    .grp{
      border:1px solid #ddd;
      border-radius: var(--radius);
      padding:10px;
      margin-top:12px;
    }

    .grp b{
      display:block;
      text-align:center;
      font-size:14px;
      margin-bottom:6px;
    }

    /* Test isimleri: çerçeveli ve ortalı (DY/NET satırının üstü) */
    .grp label{
      border: 1px solid rgba(0,0,0,0.12);
      border-radius: var(--radius);
      padding: 6px 8px;
      text-align: center;
      background: rgba(255,255,255,0.55);
      box-sizing: border-box;
    }

    #sonuc{
      margin-top:16px;
      font-size:20px;
      font-weight:800;
      text-align:center;
    }

    #sira{
      margin-top:8px;
      font-size:16px;
      font-weight:700;
      text-align:center;
    }

    .hint{
      font-size:12px;
      color:#555;
      margin-top:6px;
      text-align:center;
    }

    @media (max-width: 420px){
      :root{
        --page-w: 92vw;
        --control-w: 85%;
      }
    }

    /* === ARKA PLAN FOTO (PC + MOBİL) === */
    body::before{
      content:"";
      position:fixed;
      inset:0;
      background-image: url("umut.jpeg");
      background-repeat:no-repeat;
      background-size:cover;
      background-position: 65% center; /* PC kadraj */
      opacity:0.22;                    /* transparan, flu YOK */
      z-index:-1;
      pointer-events:none;
    }

    /* Tüm içerik foto üstünde kalsın */
    body > *{
      position:relative;
      z-index:1;
    }

    /* === MOBİL AYAR === */
    @media (max-width: 600px){
      body::before{
        background-position: 50% 20%;  /* yüz yukarıda */
        background-size: 160%;         /* yüz büyük */
        opacity:0.18;
      }
    }

    /* === AKILLI UYARI (satır) === */
    .warnline{
      width: var(--control-w);
      margin: 10px auto 0;
      padding: 10px 12px;
      border-radius: 10px;
      border: 1px solid rgba(180,0,0,0.18);
      background: rgba(255, 230, 230, 0.55);
      color: #5a0000;
      font-size: 12.5px;
      line-height: 1.4;
      display:none;
    }
    .warnline b{ font-weight:800; }

    /* === NEDEN HESAPLANMADI? (MODAL) === */
    .modalOverlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,0.45);
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      z-index:9999;
    }
    .modalCard{
      width: min(520px, 92vw);
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,0.10);
      background: rgba(255,255,255,0.92);
      box-shadow: 0 12px 35px rgba(0,0,0,0.20);
      padding: 16px 16px 14px;
    }
    .modalTitle{
      font-size: 18px;
      font-weight: 900;
      margin: 0 0 8px;
      color:#111;
      text-align:left;
    }
    .modalText{
      font-size: 13.5px;
      line-height: 1.5;
      color:#222;
      margin: 0 0 12px;
      white-space: pre-line;
    }
    .modalActions{
      display:flex;
      gap:10px;
      justify-content:flex-end;
      align-items:center;
    }
    .modalBtn{
      width:auto;
      margin:0;
      padding:10px 14px;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.10);
      background:#111;
      color:#fff;
      font-weight: 800;
      font-size: 14px;
      cursor:pointer;
    }
    .modalBtnLight{
      background: rgba(255,255,255,0.9);
      color:#111;
    }
  
    /* DY-NET satırı: Doğru / Yanlış / Net (Net = D - Y/4) */
    .dywrap{
      display:flex;
      align-items:center;
      gap:8px;
      margin: 0 0 10px 0;
    }
    .dywrap > .dy{
      width: 101px; /* 56px -> %80 arttırıldı */
      padding: 8px;
      border: 1px solid #bbb;
      border-radius: var(--radius);
      box-sizing: border-box;
      font-size: 14px;
      text-align:center;
    }
    .dywrap > input:not(.dy){
      width: 101px; /* NET hücresi, Doğru/Yanlış ile aynı */
      padding: 8px;
      border: 1px solid #bbb;
      border-radius: var(--radius);
      box-sizing: border-box;
      text-align:center;
    }
/* === YKS / LGS MOD SEÇİMİ === */
    .hidden{ display:none !important; }

    .modehint{
      text-align:center;
      font-size: 13px;
      color:#333;
      margin-top: 4px;
      margin-bottom: 6px;
    }
    .modebar{
      width: var(--control-w);
      margin: 10px auto 14px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:center;
    }
    .modebtn{
      flex:1 1 auto;
      width:auto;              /* genel button width'ünü override et */
      margin:0;
      padding:10px 0;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,0.12);
      background:#f5f5f5;
      color:#111;
      font-weight:900;
      cursor:pointer;
    }
    .modebtn.active{
      background:#111;
      color:#fff;
    }

  
    .testhdr{
      margin: 10px 0 6px;
      padding: 8px 6px;
      border: 1px solid rgba(0,0,0,0.18);
      border-radius: var(--radius);
      background: rgba(255,255,255,0.65);
      text-align:center;
      font-weight:900;
    }

  </style>

  <!-- GoatCounter -->
  <script data-goatcounter="https://gerginix.goatcounter.com/count"
          async src="//gc.zgo.at/count.js"></script>
</head>

<body>


<div class="modehint"><b>Sınav seç:</b></div>
<div class="modebar" id="modeBar">
  <button id="modeYKS" class="modebtn" type="button">YKS</button>
  <button id="modeLGS" class="modebtn" type="button">LGS</button>
</div>


<div id="introHome">
  <div class="subtitle">
    Bu simülatör, yıl boyunca girdiğiniz deneme sınavlarında ürettiğiniz netlere dayanarak,
    sizi resmî yerleştirme sonuçlarına en yakın şekilde konumlandırmayı amaçlar.
    <br><br>
    Seçtiğiniz sınav türüne göre;
    <br>
    <b>YKS</b> adayları için <b>puan ve sıralama</b>,
    <br>
    <b>LGS</b> adayları için <b>puan ve yüzdelik dilim</b>
    hesaplanır.
    <br><br>
    Hesaplamalar, ilgili yılın resmî katsayıları ve yerleştirme verileri esas alınarak yapılır.
    Bu nedenle sonuçlar bir tahmin değil, deneme performansınızın gerçekçi bir simülasyonudur.
    <br><br>
    Devam etmek için lütfen <b>sınav türünüzü seçin</b>.
  </div>

  
  <!-- LGS GİRİŞ ALANI -->
  <div id="lgsForm" style="margin-top:12px; text-align:left;">
    <label for="lgs_il">İl</label>
    <select id="lgs_il" style="width:100%;">
      <option value="">— İl seç —</option>
    </select>

    <div style="height:10px"></div>

    <div class="testhdr">TÜRKÇE (20 Soru)</div>
    <div class="dywrap">
      <input id="lgs_tr_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="D" />
      <input id="lgs_tr_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="Y" />
      <input id="lgs_tr_n" type="number" inputmode="decimal" min="-20" max="20" step="0.25" placeholder="NET" />
    </div>

    <div class="testhdr">İNKILAP TARİHİ (10 Soru)</div>
    <div class="dywrap">
      <input id="lgs_ink_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="D" />
      <input id="lgs_ink_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="Y" />
      <input id="lgs_ink_n" type="number" inputmode="decimal" min="-10" max="10" step="0.25" placeholder="NET" />
    </div>

    <div class="testhdr">DİN KÜLTÜRÜ (10 Soru)</div>
    <div class="dywrap">
      <input id="lgs_din_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="D" />
      <input id="lgs_din_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="Y" />
      <input id="lgs_din_n" type="number" inputmode="decimal" min="-10" max="10" step="0.25" placeholder="NET" />
    </div>

    <div class="testhdr">İNGİLİZCE (10 Soru)</div>
    <div class="dywrap">
      <input id="lgs_ing_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="D" />
      <input id="lgs_ing_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="10" step="1" placeholder="Y" />
      <input id="lgs_ing_n" type="number" inputmode="decimal" min="-10" max="10" step="0.25" placeholder="NET" />
    </div>

    <div class="testhdr">MATEMATİK (20 Soru)</div>
    <div class="dywrap">
      <input id="lgs_mat_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="D" />
      <input id="lgs_mat_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="Y" />
      <input id="lgs_mat_n" type="number" inputmode="decimal" min="-20" max="20" step="0.25" placeholder="NET" />
    </div>

    <div class="testhdr">FEN BİLİMLERİ (20 Soru)</div>
    <div class="dywrap">
      <input id="lgs_fen_d" class="dy dy-d" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="D" />
      <input id="lgs_fen_y" class="dy dy-y" type="number" inputmode="numeric" min="0" max="20" step="1" placeholder="Y" />
      <input id="lgs_fen_n" type="number" inputmode="decimal" min="-20" max="20" step="0.25" placeholder="NET" />
    </div>

    <div style="height:12px"></div>

    <button id="lgs_hesapla" style="width:100%; padding:10px; border-radius:10px; border:1px solid #111; background:#111; color:#fff; font-weight:700; cursor:pointer;">
      HESAPLA (LGS)
    </button>

    <div id="lgs_warn" style="margin-top:10px; color:#b00020; font-weight:700; display:none;"></div>

    <div id="lgs_out" style="margin-top:12px; display:none;">
      <div style="display:flex; gap:10px;">
        <div style="flex:1; border:1px solid #ddd; border-radius:10px; padding:10px; text-align:center;">
          <div style="font-weight:900;">PUAN</div>
          <div id="lgs_puan" style="font-size:18px; font-weight:900;">—</div>
        </div>
        <div style="flex:1; border:1px solid #ddd; border-radius:10px; padding:10px; text-align:center;">
          <div style="font-weight:900;">YÜZDELİK</div>
          <div id="lgs_yuzde" style="font-size:18px; font-weight:900;">—</div>
        </div>
      </div>

      <div style="height:14px"></div>

      <div style="font-weight:900; margin-bottom:6px;">2025 PUAN’a göre girebildiği okullar (ilk 12)</div>
      <div id="lgs_list1"></div>

      <div style="height:14px"></div>

      <div style="font-weight:900; margin-bottom:6px;">2025 2. YER. PUANI’na göre girebildiği okullar (ilk 12)</div>
      <div id="lgs_list2"></div>
    </div>
  </div>

<div class="igline">
    <span class="igicon" aria-hidden="true">
      <svg viewBox="0 0 24 24" width="18" height="18" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Instagram">
        <path d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2Zm0 2A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4h-9ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm5.4-2.15a1.15 1.15 0 1 1 0 2.3 1.15 1.15 0 0 1 0-2.3Z"/>
      </svg>
    </span>

    <span>Daha fazlası için instagram hesabımı takip edebilrsiniz:</span>
    <a href="https://instagram.com/umutsahin.tr" target="_blank" rel="noopener">
      instagram.com/umutsahin.tr
    </a>
  </div>
</div>

<div id="introYKS" class="hidden">


<h1>YKS 2025 PUAN VE SIRA SİMÜLATÖRÜ</h1>

<div class="subtitle">
  2026 YKS hazırlığınızı sürdürürken deneme sınavlarında ürettiğiniz netlerin,
  sizi 2025 YKS'de kaç puanla hangi puan türünde kaçıncı yapacağını görmek için
  bu PUAN ve SIRALAMA simülatörünü yıl boyunca kullanmaya devam edin.
  <br><br>
  OBP kısmına güncel OBP'nizi yazarak 2025 YKS YERLEŞTİRME PUANINIZI ve
  SIRALAMANIZI %99,5 oranında doğru hesaplayacaktır.
</div>

<div class="igline">
  <span class="igicon" aria-hidden="true">
    <svg viewBox="0 0 24 24" width="18" height="18" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Instagram">
      <path d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2Zm0 2A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4h-9ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm5.4-2.15a1.15 1.15 0 1 1 0 2.3 1.15 1.15 0 0 1 0-2.3Z"/>
    </svg>
  </span>

  <span>Daha fazlası için instagram hesabımı takip edebilrsiniz:</span>
  <a href="https://instagram.com/umutsahin.tr" target="_blank" rel="noopener">
    instagram.com/umutsahin.tr
  </a>
</div>

<div class="disclaimer">
  Bu sonuçlar bir <b>simülasyondur</b>. Gerçek YKS sonuçları; sınavın zorluk düzeyi, standart sapma ve ÖSYM hesaplamalarına göre değişebilir.
</div>



</div>


<div id="lgsUI" class="hidden" style="text-align:center; margin: 14px auto 0; width: var(--control-w);">
  <h1 style="margin: 6px 0 10px; font-size: 22px;">LGS 2025 PUAN ve YÜZDELİK SİMÜLATÖRÜ</h1>

  <div class="subtitle" style="margin-bottom: 10px;">
    2026 LGS hazırlığınızı sürdürürken deneme sınavlarında ürettiğiniz netlerin,
    sizi 2025 LGS yerleştirmesinde hangi puana ve hangi yüzdelik dilime taşıyabileceğini görmek için
    bu PUAN ve YÜZDELİK simülatörünü yıl boyunca kullanmaya devam edin.
    <br><br>
    Netlerinizi doğru/yanlış veya doğrudan net olarak girebilirsiniz. Sistem, puanınızı ve yüzdelik diliminizi hesapladıktan sonra
    2025 yerleştirme verisine göre girebileceğiniz okulları listeler (en fazla 12 okul).
    <br><br>
    <span style="font-size:12px; color:#444;">
      Bu sonuçlar bir <b>simülasyondur</b>. Gerçek LGS sonuçları; sınavın zorluk düzeyi ve resmî hesaplama yöntemine göre değişebilir.
    </span>
  </div>

  <div class="igline">
    <span class="igicon" aria-hidden="true">
      <svg viewBox="0 0 24 24" width="18" height="18" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Instagram">
        <path d="M7.5 2h9A5.5 5.5 0 0 1 22 7.5v9A5.5 5.5 0 0 1 16.5 22h-9A5.5 5.5 0 0 1 2 16.5v-9A5.5 5.5 0 0 1 7.5 2Zm0 2A3.5 3.5 0 0 0 4 7.5v9A3.5 3.5 0 0 0 7.5 20h9a3.5 3.5 0 0 0 3.5-3.5v-9A3.5 3.5 0 0 0 16.5 4h-9ZM12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10Zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm5.4-2.15a1.15 1.15 0 1 1 0 2.3 1.15 1.15 0 0 1 0-2.3Z"/>
      </svg>
    </span>

    <span>Daha fazlası için instagram hesabımı takip edebilrsiniz:</span>
    <a href="https://instagram.com/umutsahin.tr" target="_blank" rel="noopener">
      instagram.com/umutsahin.tr
    </a>
  </div>
</div>

</div>

<div id="yksUI" class="hidden">
<label>Puan Türü</label>
<select id="puanTuru">
  <option value="SAY">SAY</option>
  <option value="EA">EA</option>
  <option value="SOZ">SÖZ</option>
  <option value="DIL">DİL</option>
</select>

<label>OBP (0–100)</label>
<input id="obp" type="number" step="0.01" placeholder="Örn: 85,50" />
<div class="hint">Virgül veya nokta ile yazabilirsin.</div>

<div class="grp">
  <b>TYT Netleri</b>
  <label>TYT Türkçe</label>
  <div class="dywrap"><input id="tyt_tr_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="tyt_tr_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="tyt_tr" type="number" step="0.25"  placeholder="NET" /></div>
  <label>TYT Sosyal</label>
  <div class="dywrap"><input id="tyt_sos_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="tyt_sos_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="tyt_sos" type="number" step="0.25"  placeholder="NET" /></div>
  <label>TYT Matematik</label>
  <div class="dywrap"><input id="tyt_mat_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="tyt_mat_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="tyt_mat" type="number" step="0.25"  placeholder="NET" /></div>
  <label>TYT Fen</label>
  <div class="dywrap"><input id="tyt_fen_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="tyt_fen_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="tyt_fen" type="number" step="0.25"  placeholder="NET" /></div>
</div>

<div id="grp_say" class="grp">
  <b>AYT (SAY)</b>
  <label>AYT Matematik</label>
  <div class="dywrap"><input id="ayt_mat_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_mat_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_mat" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Fizik</label>
  <div class="dywrap"><input id="ayt_fiz_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_fiz_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_fiz" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Kimya</label>
  <div class="dywrap"><input id="ayt_kim_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_kim_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_kim" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Biyoloji</label>
  <div class="dywrap"><input id="ayt_bio_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_bio_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_bio" type="number" step="0.25"  placeholder="NET" /></div>
</div>

<div id="grp_ea" class="grp" style="display:none">
  <b>AYT (EA)</b>
  <label>AYT Matematik</label>
  <div class="dywrap"><input id="ayt_mat_ea_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_mat_ea_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_mat_ea" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Edebiyat</label>
  <div class="dywrap"><input id="ayt_edeb_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_edeb_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_edeb" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Tarih-1</label>
  <div class="dywrap"><input id="ayt_tar1_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_tar1_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_tar1" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Coğrafya-1</label>
  <div class="dywrap"><input id="ayt_cog1_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_cog1_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_cog1" type="number" step="0.25"  placeholder="NET" /></div>
</div>

<div id="grp_soz" class="grp" style="display:none">
  <b>AYT (SÖZ)</b>
  <label>AYT Edebiyat</label>
  <div class="dywrap"><input id="ayt_edeb_soz_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_edeb_soz_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_edeb_soz" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Tarih-1</label>
  <div class="dywrap"><input id="ayt_tar1_soz_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_tar1_soz_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_tar1_soz" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Coğrafya-1</label>
  <div class="dywrap"><input id="ayt_cog1_soz_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_cog1_soz_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_cog1_soz" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Tarih-2</label>
  <div class="dywrap"><input id="ayt_tar2_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_tar2_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_tar2" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Coğrafya-2</label>
  <div class="dywrap"><input id="ayt_cog2_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_cog2_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_cog2" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT Felsefe Grubu</label>
  <div class="dywrap"><input id="ayt_fels_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_fels_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_fels" type="number" step="0.25"  placeholder="NET" /></div>
  <label>AYT DKAB</label>
  <div class="dywrap"><input id="ayt_dkab_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ayt_dkab_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ayt_dkab" type="number" step="0.25"  placeholder="NET" /></div>
</div>

<div id="grp_dil" class="grp" style="display:none">
  <b>YDT (DİL)</b>
  <label>YDT Net</label>
  <div class="dywrap"><input id="ydt_d" class="dy dy-d" type="number" step="1" placeholder="D" inputmode="numeric" /><input id="ydt_y" class="dy dy-y" type="number" step="1" placeholder="Y" inputmode="numeric" /><input id="ydt" type="number" step="0.25"  placeholder="NET" /></div>
</div>

<button id="hesaplaBtn">HESAPLA</button>

<div id="sonuc">—</div>
<div id="sira">—</div>

<!-- Akıllı uyarı satırı (kural tutmazsa burada da görünür) -->
<div id="uyariSatiri" class="warnline"></div>

<button id="paylasBtn" class="btn-secondary" type="button">SONUCU PAYLAŞ</button>
<div id="paylasMesaj" class="hint" style="display:none;"></div>

<!-- === NEDEN HESAPLANMADI? MODAL === -->
<div id="hataOverlay" class="modalOverlay" aria-hidden="true">
  <div class="modalCard" role="dialog" aria-modal="true" aria-labelledby="hataBaslik">
    <div id="hataBaslik" class="modalTitle">Puan hesaplanamadı</div>
    <div id="hataMetin" class="modalText"></div>
    <div class="modalActions">
      <button id="hataKapat2" class="modalBtn modalBtnLight" type="button">Alanlara dön</button>
      <button id="hataKapat" class="modalBtn" type="button">Kapat</button>
    </div>
  </div>
</div>

</div>

<script src="app.js"></script>

<script>
  (function(){
    // --- yardımcılar ---
    function readNumber(id){
      const el = document.getElementById(id);
      if (!el) return 0;
      const raw = (el.value ?? "").toString().trim();
      const normalized = raw.replace(",", ".");
      const n = Number(normalized);
      return Number.isFinite(n) ? n : 0;
    }
    function round2(x){ return Math.round(x * 100) / 100; }

    // --- modal kontrol ---
    const overlay = document.getElementById("hataOverlay");
    const hataMetin = document.getElementById("hataMetin");
    const kapatBtn = document.getElementById("hataKapat");
    const kapatBtn2 = document.getElementById("hataKapat2");
    const uyari = document.getElementById("uyariSatiri");

    function closeModal(){
      if (overlay) overlay.style.display = "none";
      if (overlay) overlay.setAttribute("aria-hidden", "true");
    }
    function openModal(text){
      if (hataMetin) hataMetin.textContent = text;
      if (overlay){
        overlay.style.display = "flex";
        overlay.setAttribute("aria-hidden", "false");
      }
    }
    if (kapatBtn) kapatBtn.addEventListener("click", closeModal);
    if (kapatBtn2) kapatBtn2.addEventListener("click", closeModal);
    if (overlay){
      overlay.addEventListener("click", (e) => {
        if (e.target === overlay) closeModal();
      });
    }

    // --- Akıllı metin üretimi ---
    function buildRuleMessage(tur, sum){
      const s = round2(sum);
      const need = 0.50;

      const titleLine = tur + " yerleştirme puanının oluşması için\n";
      const ruleLine =
        (tur === "DIL")
          ? "YDT'den toplam en az 0,50 net gerekir."
          : "ilgili AYT testlerinden toplam en az 0,50 net gerekir.";

      let which = "";
      let example = "";

      if (tur === "SAY"){
        const mat = readNumber("ayt_mat");
        const fiz = readNumber("ayt_fiz");
        const kim = readNumber("ayt_kim");
        const bio = readNumber("ayt_bio");
        which =
          "SAY için geçerli testler: AYT Matematik, Fizik, Kimya, Biyoloji.\n" +
          "Şu an: Mat=" + mat + ", Fiz=" + fiz + ", Kim=" + kim + ", Bio=" + bio + ".";
        example = "Örnek: AYT Matematik'i 0,50 yap ve tekrar dene.";
      } else if (tur === "EA"){
        const mat = readNumber("ayt_mat_ea");
        const edb = readNumber("ayt_edeb");
        const tar = readNumber("ayt_tar1");
        const cog = readNumber("ayt_cog1");
        which =
          "EA için geçerli testler: AYT Matematik, Edebiyat, Tarih-1, Coğrafya-1.\n" +
          "Şu an: Mat=" + mat + ", Edeb=" + edb + ", Tar1=" + tar + ", Coğ1=" + cog + ".";
        example = "Örnek: Edebiyat'ı 0,50 yap ve tekrar dene.";
      } else if (tur === "SOZ"){
        const edb = readNumber("ayt_edeb_soz");
        const tar1 = readNumber("ayt_tar1_soz");
        const cog1 = readNumber("ayt_cog1_soz");
        const tar2 = readNumber("ayt_tar2");
        const cog2 = readNumber("ayt_cog2");
        const fels = readNumber("ayt_fels");
        const dkab = readNumber("ayt_dkab");
        which =
          "SÖZ için geçerli testler: Edebiyat, Tarih-1, Coğrafya-1, Tarih-2, Coğrafya-2, Felsefe, DKAB.\n" +
          "Şu an: Edeb=" + edb + ", Tar1=" + tar1 + ", Coğ1=" + cog1 + ", Tar2=" + tar2 + ", Coğ2=" + cog2 + ", Fels=" + fels + ", DKAB=" + dkab + ".";
        example = "Örnek: Edebiyat'ı 0,50 yap ve tekrar dene.";
      } else if (tur === "DIL"){
        const ydt = readNumber("ydt");
        which =
          "DİL için geçerli test: YDT.\n" +
          "Şu an: YDT=" + ydt + ".";
        example = "Örnek: YDT'yi 0,50 yap ve tekrar dene.";
      }

      const sumLine = "\n\nŞu anki toplamın: " + s.toFixed(2) + "\nGerekli minimum: " + need.toFixed(2);

      return titleLine + ruleLine + "\n\n" + which + sumLine + "\n\n" + example;
    }

    function setWarnline(text){
      if (!uyari) return;
      uyari.textContent = text;
      uyari.style.display = "block";
    }
    function clearWarnline(){
      if (!uyari) return;
      uyari.style.display = "none";
      uyari.textContent = "";
    }

    // --- KURAL: AYT/YDT toplam >= 0,50 değilse HESAPLA engellenir ---
    document.addEventListener("DOMContentLoaded", () => {
      const turSelect = document.getElementById("puanTuru");
      const btn = document.getElementById("hesaplaBtn");
      const sonucEl = document.getElementById("sonuc");
      const siraEl = document.getElementById("sira");

      if (!turSelect || !btn || !sonucEl || !siraEl) return;

      // Puan türü değişince uyarıları temizle
      turSelect.addEventListener("change", () => {
        clearWarnline();
        closeModal();
      });

      // CAPTURE: app.js'in click handler'ından ÖNCE çalışır
      btn.addEventListener("click", (e) => {
        const tur = turSelect.value;

        let sum = 0;
        if (tur === "SAY"){
          sum =
            readNumber("ayt_mat") +
            readNumber("ayt_fiz") +
            readNumber("ayt_kim") +
            readNumber("ayt_bio");
        } else if (tur === "EA"){
          sum =
            readNumber("ayt_mat_ea") +
            readNumber("ayt_edeb") +
            readNumber("ayt_tar1") +
            readNumber("ayt_cog1");
        } else if (tur === "SOZ"){
          sum =
            readNumber("ayt_edeb_soz") +
            readNumber("ayt_tar1_soz") +
            readNumber("ayt_cog1_soz") +
            readNumber("ayt_tar2") +
            readNumber("ayt_cog2") +
            readNumber("ayt_fels") +
            readNumber("ayt_dkab");
        } else if (tur === "DIL"){
          sum = readNumber("ydt");
        }

        // KURAL
        if (sum < 0.5){
          // app.js'i durdur
          e.preventDefault();
          e.stopPropagation();
          if (typeof e.stopImmediatePropagation === "function") e.stopImmediatePropagation();

          // sonuçları sıfırla
          sonucEl.textContent = "—";
          siraEl.textContent = "—";

          const msg = buildRuleMessage(tur, sum);

          // satır uyarı + modal ekran
          setWarnline("⚠️ " + tur + " puanı için ilgili AYT/YDT toplamın 0,50'nin altında. (Şu an: " + round2(sum).toFixed(2) + ") Detay için ekrana bak.");
          openModal(msg);
          return;
        }

        // Kural sağlandıysa: hiçbir şeye karışma
        clearWarnline();
        closeModal();

      }, true); // <-- capture
    });
  })();
</script>

<script>
  (function(){
    const btn = document.getElementById("paylasBtn");
    const msg = document.getElementById("paylasMesaj");
    const sonucEl = document.getElementById("sonuc");
    const siraEl = document.getElementById("sira");

    if (!btn || !msg || !sonucEl || !siraEl) return;

    function cleanText(t){ return (t || "").toString().trim(); }

    function getShareText(){
      const sonuc = cleanText(sonucEl.textContent);
      const sira  = cleanText(siraEl.textContent);
      const url   = window.location.href;

      const lines = [];
      lines.push("YKS 2025 Puan ve Sıra Simülatörü");
      if (sonuc && sonuc !== "—") lines.push(sonuc);
      if (sira && sira !== "—")  lines.push(sira);
      lines.push(url);
      return lines.join("\n");
    }

    async function copyToClipboard(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        const ta = document.createElement("textarea");
        ta.value = text;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.focus();
        ta.select();
        let ok = false;
        try{ ok = document.execCommand("copy"); }catch(_){ ok = false; }
        document.body.removeChild(ta);
        return ok;
      }
    }

    btn.addEventListener("click", async () => {
      const sonuc = cleanText(sonucEl.textContent);
      if (!sonuc || sonuc === "—") {
        msg.style.display = "block";
        msg.textContent = "Önce HESAPLA’ya basıp sonucu üret.";
        return;
      }

      const text = getShareText();

      if (navigator.share) {
        try{
          await navigator.share({
            title: "YKS 2025 Puan ve Sıra Simülatörü",
            text: text
          });
          msg.style.display = "block";
          msg.textContent = "Paylaşım ekranı açıldı.";
          return;
        }catch(e){
          // iptal
        }
      }

      const ok = await copyToClipboard(text);
      msg.style.display = "block";
      msg.textContent = ok ? "Kopyalandı. WhatsApp/DM’ye yapıştırabilirsin." : "Kopyalanamadı. Tarayıcı izin vermedi.";
    });
  })();
</script>


<script>
/* =====================================================
   YKS DOĞRU / YANLIŞ -> NET OTOMATİK (YKS motorunu bozmaz)
   - Net input id'leri AYNI kalır (tyt_tr, ayt_mat, ...)
   - Yeni alanlar: <id>_d ve <id>_y
   - Kural: Net = D - Y/4
   - Kural: D + Y <= maxSoru (aşarsa Y kısılır)
   - Negatif net mümkün (D/Y sayıları negatif olamaz)
===================================================== */
(function(){
  const MAXQ = {
    tyt_tr: 40, tyt_sos: 20, tyt_mat: 40, tyt_fen: 20,
    ayt_mat: 40, ayt_fiz: 14, ayt_kim: 13, ayt_bio: 13,
    ayt_mat_ea: 40, ayt_edeb: 24, ayt_tar1: 10, ayt_cog1: 6,
    ayt_edeb_soz: 24, ayt_tar1_soz: 10, ayt_cog1_soz: 6,
    ayt_tar2: 11, ayt_cog2: 11, ayt_fels: 12, ayt_dkab: 6,
    ydt: 80
  };

  function toInt(val){
    const s = (val ?? "").toString().trim();
    if (!s) return null;
    const n = Number(s.replace(",", "."));
    if (!Number.isFinite(n)) return null;
    return Math.trunc(n);
  }

  function fmtNet(x){
    // 0.25 adımlı; ama küsurat çıkarsa da düzgün yaz
    const r = Math.round(x * 1000) / 1000;
    return (Math.abs(r) < 1e-12) ? "0" : String(r);
  }

  function bindOne(id){
    const netEl = document.getElementById(id);
    const dEl = document.getElementById(id + "_d");
    const yEl = document.getElementById(id + "_y");
    if (!netEl || !dEl || !yEl) return;

    const max = MAXQ[id];

    function recalc(){
      const dRaw = toInt(dEl.value);
      const yRaw = toInt(yEl.value);

      // İkisi de boşsa net manuel kalsın
      if (dRaw === null && yRaw === null){
        netEl.readOnly = false;
        return;
      }

      let d = (dRaw === null) ? 0 : dRaw;
      let y = (yRaw === null) ? 0 : yRaw;

      // Doğru/yanlış negatif olamaz
      if (d < 0) d = 0;
      if (y < 0) y = 0;

      // Üst limit (tek tek)
      if (d > max) d = max;
      if (y > max) y = max;

      // D+Y aşarsa yanlış kıs
      if (d + y > max){
        y = Math.max(0, max - d);
      }

      // UI'ya geri yaz (düzeltme olduysa)
      if (dRaw !== null && dEl.value !== String(d)) dEl.value = String(d);
      if (yRaw !== null && yEl.value !== String(y)) yEl.value = String(y);

      const net = d - (y / 4);
      netEl.value = fmtNet(net);
      netEl.readOnly = true;
    }

    dEl.addEventListener("input", recalc);
    yEl.addEventListener("input", recalc);
    dEl.addEventListener("blur", recalc);
    yEl.addEventListener("blur", recalc);

    // Sayfa ilk açılışında da hesapla
    recalc();
  }

  function init(){
    Object.keys(MAXQ).forEach(bindOne);
  }

  if (document.readyState === "loading") document.addEventListener("DOMContentLoaded", init);
  else init();
})();
</script>



<script>
/* ===== LGS MOTOR (Excel verisine bağlı) ===== */
(() => {
  const PATH_KAYNAK = "data/lgs/LGS_KAYNAK_FULL_VALUES.json";
  const PATH_KATS   = "data/lgs/LGS_KATSAYILAR_A1_D8_VALUES.json";

  const el = (id) => document.getElementById(id);

  const UI = {
    il: el("lgs_il"),
    btn: el("lgs_hesapla"),
    warn: el("lgs_warn"),
    out: el("lgs_out"),
    puan: el("lgs_puan"),
    yuzde: el("lgs_yuzde"),
    list1: el("lgs_list1"),
    list2: el("lgs_list2"),
  };

  const TESTS = [
    { key:"TR",  name:"TÜRKÇE",          max:20, d:"lgs_tr_d",  y:"lgs_tr_y",  n:"lgs_tr_n"  },
    { key:"INK", name:"İNKILAP TARİHİ",  max:10, d:"lgs_ink_d", y:"lgs_ink_y", n:"lgs_ink_n" },
    { key:"DIN", name:"DİN KÜLTÜRÜ",     max:10, d:"lgs_din_d", y:"lgs_din_y", n:"lgs_din_n" },
    { key:"ING", name:"İNGİLİZCE",       max:10, d:"lgs_ing_d", y:"lgs_ing_y", n:"lgs_ing_n" },
    { key:"MAT", name:"MATEMATİK",       max:20, d:"lgs_mat_d", y:"lgs_mat_y", n:"lgs_mat_n" },
    { key:"FEN", name:"FEN BİLİMLERİ",   max:20, d:"lgs_fen_d", y:"lgs_fen_y", n:"lgs_fen_n" },
  ];

  let kaynak = null; // {headers, rows}
  let kats = null;   // 2D array
  let col = null;    // indices

  const toNum = (v) => {
    if (v === null || v === undefined) return NaN;
    if (typeof v === "number") return v;
    const s = String(v).trim().replace(/\./g,"").replace(",",".");
    const n = Number(s);
    return Number.isFinite(n) ? n : NaN;
  };

  function showWarn(msg){
    UI.warn.textContent = msg;
    UI.warn.style.display = "block";
  }
  function clearWarn(){
    UI.warn.textContent = "";
    UI.warn.style.display = "none";
  }

  async function loadOnce(){
    if (kaynak && kats && col) return;

    const [kres, cRes] = await Promise.all([
      fetch(PATH_KAYNAK, {cache:"no-store"}),
      fetch(PATH_KATS,   {cache:"no-store"}),
    ]);

    if (!kres.ok) throw new Error("KAYNAK verisi yüklenemedi: " + kres.status);
    if (!cRes.ok) throw new Error("KATSAYILAR verisi yüklenemedi: " + cRes.status);

    kaynak = await kres.json();
    kats = await cRes.json();

    const headers = kaynak.headers || [];
    const idx = (name) => headers.indexOf(name);

    col = {
      il: idx("İl Adı"),
      ilce: idx("İlçe Adı"),
      okul: idx("Okul Adı"),
      puan25: idx("2025 PUAN"),
      puan25_2: idx("2025 2. YER. PUANI"),
      yuzde25: idx("2025 En Düşük % Dilim"),
      yuzde25_nakil: idx("2025 En Düşük Nakil Sonrası % Dilim"),
    };

    // Zorunlu kolon kontrolü (Excel başlığı birebir)
    const required = ["il","okul","puan25","yuzde25","puan25_2","ilce"];
    const miss = required.filter(k => col[k] === -1);
    if (miss.length){
      throw new Error("KAYNAK başlık(lar)ı bulunamadı: " + miss.join(", "));
    }
  }

  function fillIlDropdown(){
    if (!UI.il || !kaynak || !col) return;
    const seen = new Set();
    for (const r of (kaynak.rows||[])){
      const il = (r[col.il] ?? "").toString().trim();
      if (il) seen.add(il);
    }
    const list = Array.from(seen).sort((a,b)=>a.localeCompare(b,"tr"));
    const current = UI.il.value || "";
    UI.il.innerHTML = '<option value="">— İl seç —</option>' + list.map(x => `<option value="${x.replace(/"/g,'&quot;')}">${x}</option>`).join("");
    UI.il.value = current && seen.has(current) ? current : "";
  }

  function clampInt(x, min, max){
    x = Math.floor(Number(x));
    if (!Number.isFinite(x)) return 0;
    if (x < min) return min;
    if (x > max) return max;
    return x;
  }
  function clampNet(x, min, max){
    x = Number(x);
    if (!Number.isFinite(x)) return NaN;
    if (x < min) x = min;
    if (x > max) x = max;
    // LGS netleri 0.25 adımlı olabilir: 0.25’e yuvarla
    return Math.round(x * 4) / 4;
  }

  function attachLimits(){
    // D/Y değişince clamp + D+Y <= max
    for (const t of TESTS){
      const dEl = el(t.d), yEl = el(t.y), nEl = el(t.n);
      if (!dEl || !yEl || !nEl) continue;

      const applyDY = () => {
        let d = clampInt(dEl.value, 0, t.max);
        let y = clampInt(yEl.value, 0, t.max);
        if (d + y > t.max) {
          // önce Y’yi kırp (Excel’de genelde böyle)
          y = Math.max(0, t.max - d);
        }
        dEl.value = String(d);
        yEl.value = String(y);
        // DY kullanılıyorsa NET temizle
        if (dEl.value !== "" || yEl.value !== "") {
          // Net alanına elle yazılmışsa kullanıcı tercihi olabilir;
          // Ama DY değiştiyse NET’i boşalt.
          // Sadece DY’yi düzeltiyoruz; hesaplama DY’den yapılacak.
        }
      };

      const applyNet = () => {
        const v = nEl.value;
        if (v === "" || v === null) return;
        const n = clampNet(v, -t.max, t.max);
        if (Number.isFinite(n)) nEl.value = String(n);
      };

      dEl.addEventListener("input", () => { applyDY(); });
      yEl.addEventListener("input", () => { applyDY(); });
      nEl.addEventListener("input", () => { applyNet(); });

      // Net’e yazarsa D/Y’yi temizle (çakışma olmasın)
      nEl.addEventListener("change", () => {
        if (nEl.value !== ""){
          dEl.value = "";
          yEl.value = "";
          applyNet();
        }
      });
    }
  }

  function katsayiHaritasi(){
    // kats: 2D array; row[0]=test name, row[2]=coef, base row 0
    const map = {};
    let base = NaN;
    for (let i=1;i<kats.length;i++){
      const row = kats[i];
      if (!row) continue;
      const name = (row[0] ?? "").toString().trim().toUpperCase();
      const coef = toNum(row[2]);
      if (name === "TABAN PUAN") base = toNum(row[1]);
      if (name && Number.isFinite(coef)) map[name] = coef;
    }
    return {base, map};
  }

  function computeNetForTest(t){
    const dEl = el(t.d), yEl = el(t.y), nEl = el(t.n);
    const nRaw = (nEl && nEl.value !== "") ? toNum(nEl.value) : NaN;
    if (Number.isFinite(nRaw)){
      const n = clampNet(nRaw, -t.max, t.max);
      nEl.value = String(n);
      return n;
    }
    const d = clampInt(dEl?.value, 0, t.max);
    const y = clampInt(yEl?.value, 0, t.max);
    if (d + y > t.max){
      // input event’i kaçırmış olabilir; burada da kırp
      const y2 = Math.max(0, t.max - d);
      if (yEl) yEl.value = String(y2);
    }
    if (dEl) dEl.value = dEl.value === "" ? "" : String(d);
    if (yEl) yEl.value = yEl.value === "" ? "" : String(y);
    const net = Math.round((d - (y/3)) * 4) / 4;
    return net;
  }

  function percentileFromFirstSchool(score){
    // “Adayın kazanabildiği ilk okul”: 2025 PUAN tabanına göre en yüksek puanlı uygun satırın yüzdeliği
    const rows = (kaynak.rows||[]);
    const items = [];
    for (const r of rows){
      const p = toNum(r[col.puan25]);
      const y = toNum(r[col.yuzde25]);
      if (Number.isFinite(p) && Number.isFinite(y)) items.push({p,y});
    }
    // yüksekten düşüğe
    items.sort((a,b)=>b.p-a.p);
    for (const it of items){
      if (score >= it.p) return it.y;
    }
    return NaN;
  }

  function buildTable(list, mode){
    // mode: "puan25" or "puan25_2"
    if (!list.length){
      return '<div style="padding:10px; border:1px solid #eee; border-radius:10px; background:#fafafa;">Uygun okul bulunamadı.</div>';
    }
    const rowsHtml = list.map(x => {
      const p = Number.isFinite(x.p) ? x.p.toFixed(3).replace(".",",") : "—";
      const y = Number.isFinite(x.y) ? x.y.toFixed(3).replace(".",",") : "—";
      return `<tr>
        <td style="padding:8px; border-top:1px solid #eee;">${x.okul}</td>
        <td style="padding:8px; border-top:1px solid #eee; white-space:nowrap;">${x.ilce||""}</td>
        <td style="padding:8px; border-top:1px solid #eee; text-align:right; white-space:nowrap;">${p}</td>
        <td style="padding:8px; border-top:1px solid #eee; text-align:right; white-space:nowrap;">${y}</td>
      </tr>`;
    }).join("");
    return `<div style="border:1px solid #eee; border-radius:10px; overflow:hidden;">
      <table style="width:100%; border-collapse:collapse; font-size:13px;">
        <thead style="background:#f3f3f3;">
          <tr>
            <th style="text-align:left; padding:8px;">Okul</th>
            <th style="text-align:left; padding:8px;">İlçe</th>
            <th style="text-align:right; padding:8px;">${mode === "puan25_2" ? "2025 2. YER. PUANI" : "2025 PUAN"}</th>
            <th style="text-align:right; padding:8px;">2025 En Düşük % Dilim</th>
          </tr>
        </thead>
        <tbody>${rowsHtml}</tbody>
      </table>
    </div>`;
  }

  function listSchools(il, score, which){
    const rows = (kaynak.rows||[]);
    const out = [];
    for (const r of rows){
      const ril = (r[col.il] ?? "").toString().trim();
      if (ril !== il) continue;

      const okul = (r[col.okul] ?? "").toString().trim();
      if (!okul) continue;

      const ilce = (r[col.ilce] ?? "").toString().trim();
      const y = toNum(r[col.yuzde25]);

      const pCol = which === "puan25_2" ? col.puan25_2 : col.puan25;
      const p = toNum(r[pCol]);
      if (!Number.isFinite(p)) continue;

      // “kazanabildiği”: aday puanı >= okul puanı
      if (score >= p){
        out.push({okul, ilce, p, y});
      }
    }
    // yüksek puanlı okullar önce gelsin
    out.sort((a,b)=>b.p-a.p);
    return out.slice(0, 12);
  }

  async function onEnterLGS(){
    try{
      clearWarn();
      await loadOnce();
      fillIlDropdown();
      attachLimits();
    }catch(err){
      showWarn(String(err.message || err));
    }
  }

  async function onCompute(){
    clearWarn();
    try{
      await loadOnce();
    }catch(err){
      showWarn(String(err.message || err));
      return;
    }

    const il = UI.il?.value || "";
    if (!il){
      showWarn("İl seçmeden hesaplama yapılamaz.");
      return;
    }

    // katsayılar
    const {base, map} = katsayiHaritasi();
    if (!Number.isFinite(base)){
      showWarn("KATSAYILAR: TABAN PUAN okunamadı.");
      return;
    }

    const nets = {};
    for (const t of TESTS){
      const n = computeNetForTest(t);
      nets[t.name] = n;
    }

    // puan
    let score = base;
    for (const t of TESTS){
      const coef = map[t.name];
      if (!Number.isFinite(coef)){
        showWarn("KATSAYILAR: " + t.name + " katsayısı bulunamadı.");
        return;
      }
      score += (nets[t.name] * coef);
    }
    score = Math.round(score * 1000) / 1000;

    const yuzde = percentileFromFirstSchool(score);

    UI.out.style.display = "block";
    UI.puan.textContent = score.toFixed(3).replace(".",",");
    UI.yuzde.textContent = Number.isFinite(yuzde) ? yuzde.toFixed(3).replace(".",",") : "—";

    const list1 = listSchools(il, score, "puan25");
    const list2 = listSchools(il, score, "puan25_2");
    UI.list1.innerHTML = buildTable(list1, "puan25");
    UI.list2.innerHTML = buildTable(list2, "puan25_2");
  }

  // dışarıya “LGS moduna girince” çağrılacak kanca
  window.__lgsEnter = onEnterLGS;

  // buton
  if (UI.btn){
    UI.btn.addEventListener("click", onCompute);
  }
})();
</script>

<script>
  (function(){
    const btnYKS = document.getElementById("modeYKS");
    const btnLGS = document.getElementById("modeLGS");

    const introHome = document.getElementById("introHome");
    const introYKS  = document.getElementById("introYKS");
    const yksUI     = document.getElementById("yksUI");
    const lgsUI     = document.getElementById("lgsUI");

    function setActive(btn, on){
      if (!btn) return;
      btn.classList.toggle("active", !!on);
    }

    function hideAll(){
      if (introHome) introHome.classList.add("hidden");
      if (introYKS)  introYKS.classList.add("hidden");
      if (yksUI)     yksUI.classList.add("hidden");
      if (lgsUI)     lgsUI.classList.add("hidden");
    }

    function setMode(mode){
      hideAll();
      setActive(btnYKS, false);
      setActive(btnLGS, false);

      if (mode === "HOME"){
        if (introHome) introHome.classList.remove("hidden");
        return;
      }

      if (mode === "YKS"){
        if (introYKS) introYKS.classList.remove("hidden");
        if (yksUI)    yksUI.classList.remove("hidden");
        setActive(btnYKS, true);
        return;
      }

      if (mode === "LGS"){
        if (lgsUI)    lgsUI.classList.remove("hidden");
        setActive(btnLGS, true);
        return;
      
        if (window.__lgsEnter) window.__lgsEnter();
      }
    }

    if (btnYKS) btnYKS.addEventListener("click", () => setMode("YKS"));
    if (btnLGS) btnLGS.addEventListener("click", () => setMode("LGS"));

    // İlk açılış: seçim yok => ana sayfa metni görünsün
    setMode("HOME");
  })();
</script>


</body>
</html>
